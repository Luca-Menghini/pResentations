---
title: 'Oltre l’orario di lavoro'
subtitle: 'Gli effetti del lavoro supplementare digitale \newline sulla quantità e qualità del sonno'
author:  |
 | \fontsize{10pt}{12}\selectfont __Luca Menghini__
 | \fontsize{8pt}{10}\selectfont __Merylin Monaro, Luciano Gamberini__ 
 | \fontsize{7pt}{10}\selectfont HTLab, HIT Research Centre
 | University of Padova
 | ![](img/logo_oniri.PNG){width=2.5in}
 | _ONIRICAMENTE (II edizione) \newline \fontsize{9pt}{12}\selectfont Giornata di studi sulla Psicologia del Sonno_
 | \fontsize{6pt}{10}\selectfont Università LUMSA, Roma, 13 giugno 2025 \color{blue}
 |
 |
logo: img/logo3_oniri.png
output:
  beamer_presentation:
    fonttheme: serif
    theme: Singapore
    slide_level: 2
    includes:
      in_header: mystyle.tex
---

# Background

## Digital Work-Life Balance

```{r , echo = FALSE, out.width="100px",fig.align='center'}
knitr::include_graphics("img/dwlb.png")
```

\fontsize{9pt}{10}\selectfont

- __Work-Life Balance__ \newline = extent to which an individual is equally engaged in - and equally satisfied with - their **work** and **family** \color{red} [and other non-work] \color{black} role\color{red}[s] \color{black} \fontsize{6pt}{10}\selectfont Greenhaus et al (2003) \fontsize{9pt}{10}\selectfont

- Multifaceted & bidirectional: Conflicts, facilitation, enrichment, etc.

- __Digital Transition Era__: \newline Mobile & pervasive technologies + Always-on connectivity \newline enabling flexibility at the cost of new forms of **digital strain**

## Digitalization & constant connectivity

\fontsize{8pt}{12}\selectfont

Work intensification & digitalization: remote working after regular work hours as a common practice &rightarrow; About 20% of European employees \fontsize{5.5pt}{10}\selectfont (Eurofound, 2017) \newline

\begincols
  \begincol{.55\textwidth}

\fontsize{8pt}{12}\selectfont

- **Techno-stress creators** \newline = Main sources of stress experienced in organizations as the result of ICT use \newline \fontsize{5.5pt}{10}\selectfont (Ragu-Nathan et al. 2008)

\fontsize{7pt}{10}\selectfont 

- Techno-overload 
- Techno-complexity 
- Techno-uncertainty 
- Techno-insecurity
- \color{red} \fontsize{8pt}{12}\selectfont __Techno-invasion__ \newline \color{red} = Invasive effect of ICT when workers can be reached anytime and feel the need to be constantly connected \color{black} \newline \newline \newline

\endcol \begincol{.55\textwidth}

\fontsize{8pt}{12}\selectfont

- __\color{red}Tech-Assisted Supplemental Work (TASW):__ \fontsize{7pt}{10}\selectfont \color{red} Self- or other- initiated ICT-mediated 'extra' job tasks outside regular work hours \color{black}

\fontsize{8pt}{12}\selectfont

- __Constant connectivity:__ \fontsize{7pt}{10}\selectfont Perpetual availability and 24/7 connectedness to the organization 

\fontsize{8pt}{12}\selectfont

- __Workplace Tele-pressure:__ \fontsize{7pt}{10}\selectfont Thinking about ICT messages accompanied and an overwhelming urge to respond 

\fontsize{8pt}{12}\selectfont

>- Problematic smartphone/e-mail use and __addiction__ to technology \newline \newline

\endcol \endcols

## **T**echnology-**A**ssisted **S**upplemental **W**ork

\fontsize{8pt}{12}\selectfont
= Performance of “role-prescribed tasks at home \newline after regular work hours with the aid of technological tools” \newline \fontsize{6pt}{8}\selectfont (Fenner & Renn, 2010)

\begincols
  \begincol{.7\textwidth}

```{r echo=FALSE,message=FALSE,warning=FALSE}
rm(list=ls())
library(DiagrammeR)
library(DiagrammeRsvg)
library(rsvg)

# Crea il diagramma e salvalo
g <- 
  grViz("
digraph model {
  graph [layout = dot, rankdir = LR]

  A [label = <
    <table border='0' cellborder='0' width='90' cellpadding='0'>
      <tr><td><b><font point-size='10'>Job</font></b></td></tr>
      <tr><td><font point-size='8'>Demands (+)</font></td></tr>
      <tr><td><font point-size='8'>Control (+)</font></td></tr>
      <tr><td><font point-size='8'>ICT infrastructure (+)</font></td></tr>
    </table>
  >, shape=box]
  
  B [label = <
    <table border='0' cellborder='0'  width='100' cellpadding='0'>
      <tr><td><b><font point-size='10'>Socio-normative</font></b></td></tr>
      <tr><td><font point-size='8'>Availability expect. (+)</font></td></tr>
      <tr><td><font point-size='8'>Work telepressure (+)</font></td></tr>
    </table>
  >, shape=box]
  
  C [label = <
    <table border='0' cellborder='0'  width='100' cellpadding='0'>
      <tr><td><b><font point-size='10'>Personal charact.</font></b></td></tr>
      <tr><td><font point-size='8'>Conscientousness (+)</font></td></tr>
      <tr><td><font point-size='8'>Boundary control (-)</font></td></tr>
      <tr><td><font point-size='8'>Gender (+M)</font></td></tr>
      <tr><td><font point-size='8'>Education (+)</font></td></tr>
      <tr><td><font point-size='8'>Job tenure (+)</font></td></tr>
      <tr><td><font point-size='8'>Job level (+)</font></td></tr>
    </table>
  >, shape=box]

  T [label = 'TASW', shape=box, color='red', fontcolor='red']
  
  D [label = <
    <table border='0' cellborder='0' width='80' cellpadding='0'>
      <tr><td><b><font point-size='10'>Recovery</font></b></td></tr>
      <tr><td><font point-size='8'>Detachment (-)</font></td></tr>
      <tr><td><font point-size='8' color='red'>Sleep quality (-)</font></td></tr>
      <tr><td><font point-size='8' color='red'>Sleep quantity (NS)</font></td></tr>
    </table>
  >, shape=box, color='red']
  
  E [label = <
    <table border='0' cellborder='0' width='70' cellpadding='0'>
      <tr><td><b><font point-size='10'>Well-being</font></b></td></tr>
      <tr><td><font point-size='8'>Psych. strain (+)</font></td></tr>
      <tr><td><font point-size='8'>Phys. strain (NS)</font></td></tr>
    </table>
  >, shape=box]
  
  F [label = <
    <table border='0' cellborder='0' width='60' cellpadding='0'>
      <tr><td><b><font point-size='10'>Work-life</font></b></td></tr>
      <tr><td><font point-size='8'>Balance (-)</font></td></tr>
      <tr><td><font point-size='8'>Conflict (+)</font></td></tr>
      <tr><td><font point-size='8'>Enrichment (+)</font></td></tr>
    </table>
  >, shape=box]
  
  G [label = <
    <table border='0' cellborder='0' width='70' cellpadding='0'>
      <tr><td><b><font point-size='10'>Work</font></b></td></tr>
      <tr><td><font point-size='8'>Satisfaction (+)</font></td></tr>
      <tr><td><font point-size='8'>Commitment (+)</font></td></tr>
      <tr><td><font point-size='8'>Performance (+)</font></td></tr>
    </table>
  >, shape=box]
  
  A -> T -> D
  B -> T -> E
  C -> T -> F
  T -> G
}
")

# Converti in SVG e poi PNG
svg <- DiagrammeRsvg::export_svg(g)
rsvg::rsvg_png(charToRaw(svg), file = "img/diagram.png", width = 900)
```

```{r , echo = FALSE, out.width="230px"}
knitr::include_graphics("img/diagram.png")
```

\endcol \begincol{.25\textwidth}
  
```{r , echo = FALSE, out.width="70px"}
knitr::include_graphics("img/tasw.png")
```
  
\fontsize{5.5pt}{12}\selectfont  
Kühner et al. (2023) \newline _J Vocat Behav_

*K* = 89 indep. samples, \newline _N_ = 39,085 employees \newline \newline

\endcol
  \endcols
  
## TASW effects on sleep quantity & quality

\fontsize{9pt}{12}\selectfont

- M-A predictive of **lower sleep quality** ($\bar{\rho}$ = -.10, *k* = 9) \newline but **unrelated with sleep quantity** ($\bar{\rho}$ = -.06, *k* = 4) \newline Yet, few studies, mainly cross-sectional self-report measurements

```{r , echo = FALSE, out.width="180px",fig.align='center'}
knitr::include_graphics("img/Eichberger_study.png")
```

- TASW-related mental and emotional activation should delay sleep onset and increase WASO \fontsize{6.5pt}{8}\selectfont  (Hyperaroual HP, Cognitive Activation Theory) \newline \fontsize{9pt}{12}\selectfont + blue-light emitters and lack of detachment \fontsize{9pt}{12}\selectfont 

- Any role played by **work-related rumination** and **chronotype**?

## Research studies (ongoing)

```{r , echo = FALSE, out.width="300px"}
knitr::include_graphics("img/loghi_DARE.png")
```
```{r , echo = FALSE, out.width="30px"}
knitr::include_graphics("img/white.png")
```

\begincols
  \begincol{.5\textwidth}

\fontsize{12pt}{12}\selectfont
Study #1 \newline \fontsize{7pt}{12}\selectfont
__Large-scale cross-sectional__ \newline
as a first step of a 3-wave 6-month-lag longitudinal study on **risk factors** for worker mental health \newline

```{r , echo = FALSE, out.width="100px"}
knitr::include_graphics("img/oniri_survey.png")
```

\fontsize{8pt}{12}\selectfont  \color{blue}
_Do **workers** performing higher TASW sleep worse than those performing lower TASW? Mediating role of rumination?_

\endcol \begincol{.5\textwidth}
  
\fontsize{12pt}{12}\selectfont
Study #2 \newline \fontsize{7pt}{12}\selectfont
__Ecological Momentary Assessment__ \newline
5-workday protocol with event-contingent ESM ($3/day$) and continuous passive wearable measures

```{r , echo = FALSE, out.width="150px"}
knitr::include_graphics("img/oniri_ema_protocol.png")
```

\fontsize{8pt}{12}\selectfont \color{blue}
_Do people sleep worse in those **workdays** where they perform higher TASW than usual? Objective vs. subjective?_

\endcol
  \endcols

# Study #1

## Participants & Procedure

```{r , echo = FALSE, out.width="70px"}
# reading data
tot <- read.csv("data/DATASETS/t1_Bilendi_clean.csv")

# removing participants with unplausible TIB
out_tib <- nrow(tot[tot$sleep_TIB_wday/60 < 3 |
                      tot$sleep_TIB_wday/60 > 10,])
tot <- 
  tot[tot$sleep_TIB_wday/60 >= 3 &
        tot$sleep_TIB_wday/60 <= 10,]

# recoding remote work
tot$remote <- FALSE
tot$remote[tot$job.hours_remote>0] <- TRUE
```

\begincols
  \begincol{.57\textwidth}

\fontsize{9pt}{12}\selectfont

`r fontawesome::fa(name = "user", height = "1em")` `r fontawesome::fa(name = "user", height = "1em")` `r fontawesome::fa(name = "user", height = "1em")` `r fontawesome::fa(name = "user", height = "1em")` `r fontawesome::fa(name = "user", height = "1em")` `r fontawesome::fa(name = "user", height = "1em")` `r fontawesome::fa(name = "user", height = "1em")` \newline
`r nrow(tot)` employed adults \fontsize{7pt}{12}\selectfont (`r round(100*nrow(tot[tot$gender=="F",])/nrow(tot),1)`%F, `r round(mean(tot$age),1)` $\pm$ `r round(sd(tot$age),1)` y) \newline
Job tenure: `r round(mean(tot$job.tenure),1)` $\pm$ `r round(sd(tot$job.tenure),1)` y, `r round(mean(tot$job.hours),1)` $\pm$ `r round(sd(tot$job.hours),1)` hours/week \newline
`r (round(100*table(tot$job.position)/nrow(tot)))[1]`% employees, `r (round(100*table(tot$job.position)/nrow(tot)))[4]`% managers, `r 100 - ((round(100*table(tot$job.position)/nrow(tot)))[1]+ (round(100*table(tot$job.position)/nrow(tot)))[4])`% other \newline
`r (round(100*table(tot$remote)/nrow(tot)))[2]`% remote/hybrid workers \newline Ongoing occupational classification with `labouR` \newline

\fontsize{9pt}{12}\selectfont
__Recruitment & Procedure__ \fontsize{7pt}{12}\selectfont \newline
Professional recruitment service  \newline

\fontsize{9pt}{12}\selectfont
__Exclusion criteria:__ \fontsize{7pt}{10}\selectfont

- Unemployed/Students/Trainees

- Less than 18 work hours/week

- Nocturnal shifts

- Careless resp. (attention checks)

- TIB < 3 or TIB > 10 hours (*n*=`r out_tib`)

\endcol \begincol{.38\textwidth}

\fontsize{9pt}{12}\selectfont `r fontawesome::fa(name = "laptop", height = "1em")` \newline __Cross-sectional online survey (~20 min)__ \newline

`r fontawesome::fa(name = "ruler", height = "1em")` \newline __Measures:__  \fontsize{7pt}{10}\selectfont

- $TASW scale$

- Sleep quantity: $\mu MCTQ$

- Sleep quality: $Mini Sleep$

- Rumination: $WRRS$

- Job demands: $QWS$

- Demographics

- Occupational

\endcol
  \endcols

## Measures

\fontsize{8pt}{12}\selectfont 
All using 5-point response scale (Never - Always) "over the last 2 weeks" \newline

\begincols
  \begincol{.5\textwidth}

\color{blue}
_TASW scale_ \fontsize{5.5pt}{12}\selectfont \color{black} (Fenner & Renn 2010) \newline \fontsize{7pt}{10}\selectfont Back-translated (e.g. _Perform job-related tasks at home at night/weekends using digital devices_) \newline

\fontsize{8pt}{12}\selectfont \color{blue}
$\mu MCTQ$ \fontsize{5.5pt}{12}\selectfont \color{black} (Ghotbi et al. 2020) \newline \fontsize{7pt}{10}\selectfont Weekday/Weekend Bedtime + Wake-up \newline &rightarrow; TIB (hours) + chronotype (min) \newline

\fontsize{8pt}{12}\selectfont \color{blue}
_Mini Sleep Qs_ \fontsize{5.5pt}{12}\selectfont \color{black} (Natale et al. 2008) \newline \fontsize{7pt}{10}\selectfont 4 items from "sleep" subscale \newline e.g., *Difficulties in falling asleep* \newline

\endcol \begincol{.5\textwidth}

\fontsize{8pt}{12}\selectfont \color{blue}
_Work-Related Rumination Scale_ \fontsize{7pt}{10}\selectfont \newline 8 items \fontsize{5.5pt}{12}\selectfont \color{black} (Cropley et al. 2012) \fontsize{7pt}{10}\selectfont \newline Back-translated & culturally adapted

\fontsize{6.5pt}{10}\selectfont

- Affective rumination (e.g. _Become tense when think about work in free time_)

- Problem-solving pondering (e.g. _Find solutions to work-related problems in free time_) \newline

\fontsize{8pt}{12}\selectfont \color{blue}
_Quant. Workload Qs_ \fontsize{5.5pt}{12}\selectfont \color{black} (Spector & Jex 1998) \newline \fontsize{7pt}{10}\selectfont 5 items (e.g. *My job requires me \newline to work very hard*) \newline

\endcol
  \endcols
  
```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=12,fig.height=1.5}
# shortening TIB label and recoding in hours
tot$TIB <- tot$sleep_TIB_wday/60

# reversing sleep quality items
tot$msq_1 <- 6 - tot$msq_1
tot$msq_2 <- 6 - tot$msq_2
tot$msq_3 <- 6 - tot$msq_3
tot$msq_4 <- 6 - tot$msq_4

library(ggplot2); library(gridExtra)
p1 <- ggplot(tot,aes(tasw_1)) + geom_histogram() + theme(axis.title.y = element_blank())
p2 <- ggplot(tot,aes(TIB))+ geom_histogram() + theme(axis.title.y = element_blank())
p3 <- ggplot(tot,aes(msq_1))+ geom_histogram() + theme(axis.title.y = element_blank()) + xlab("msq_1 (rev)")
p4 <- ggplot(tot,aes(wrrs_ar_1))+ geom_histogram() + theme(axis.title.y = element_blank())
p5 <- ggplot(tot,aes(wrrs_pp_1))+ geom_histogram() + theme(axis.title.y = element_blank())
p6 <- ggplot(tot,aes(qws_1))+ geom_histogram() + theme(axis.title.y = element_blank())
grid.arrange(p1,p2,p3,p4,p5,p6,nrow=1)
```

## Results: Correlations

```{r echo=FALSE,warning=FALSE,message=FALSE,fig.width=8,fig.height=4}
library(psych); library(reshape2); library(ggplot2)

# computing mean values
tot$TASW <- apply(tot[,paste0("tasw_",1:4)],1,mean)
tot$AR <- apply(tot[,paste0("wrrs_ar_",1:3)],1,mean)
tot$PP <- apply(tot[,paste0("wrrs_pp_",1:4)],1,mean)
tot$SQ <- apply(tot[,paste0("msq_",1:4)],1,mean)

# plotting correlations
cors <- cor(tot[,c("TASW","AR","PP","SQ","TIB")])
cors[upper.tri(cors)] <- NA
ggplot(data = reshape2::melt(cors),
       aes(x=Var1,y=Var2, fill=value)) + geom_tile() + labs(x="",y="") +
  geom_text(aes(x=Var1,y=Var2,label=round(value,2)),color="black",size=3.5)+
  scale_fill_gradient2(low="darkblue",high="#f03b20",mid="white",midpoint=0,
                       limit = c(-1,1),space="Lab",name="Pearson\nCorrelation",
                       guide="legend",breaks=round(seq(1,-1,length.out = 11),2),
                       minor_breaks=round(seq(1,-1,length.out = 11),2)) +
  theme(axis.text.x = element_text(angle=45,hjust=1))

tot$TASW <- tot$PP <- tot$AR <- tot$SQ <- NULL
```

## Results: Measurement model

```{r echo=FALSE,warning=FALSE,message=FALSE}
library(lavaan)

# model
m <- 
  '
  TASW =~ tasw_1 + tasw_2 + tasw_3 + tasw_4
  AR =~ wrrs_ar_1 + wrrs_ar_2 + wrrs_ar_3 + wrrs_ar_4
  PP =~ wrrs_pp_1 + wrrs_pp_2 + wrrs_pp_3 + wrrs_pp_4
  SQ =~ msq_1 + msq_2 + msq_3 + msq_4
  TIB ~~ TASW + AR + PP + SQ
  '

# ordered variables
ord_vars <- c(paste0("tasw_",1:4),paste0("wrrs_ar_",1:4),
              paste0("wrrs_pp_",1:4),paste0("msq_",1:4))

# fitting model
fit1 <- cfa(m,data=tot,ordered=ord_vars,
            estimator="WLSMV",std.lv=TRUE)

# fit indices
fitind <- 
  round(lavInspect(fit1,"fit")[c("rmsea","cfi","tli","srmr")],3)
# rmsea   cfi   tli  srmr 
# 0.062 0.994 0.993 0.045 

# parameters
pars <- standardizedsolution(fit1)
pars <- pars[pars$op %in% c("=~","~~") &
               pars$lhs!=pars$rhs,]
# pars
#      lhs op       rhs est.std    se       z pvalue ci.lower ci.upper
# 1   TASW =~    tasw_1   0.839 0.009  96.612  0.000    0.822    0.856
# 2   TASW =~    tasw_2   0.943 0.005 194.329  0.000    0.934    0.953
# 3   TASW =~    tasw_3   0.836 0.008  98.445  0.000    0.820    0.853
# 4   TASW =~    tasw_4   0.926 0.005 179.557  0.000    0.916    0.936
# 5     AR =~ wrrs_ar_1   0.867 0.007 116.214  0.000    0.852    0.881
# 6     AR =~ wrrs_ar_2   0.879 0.007 130.957  0.000    0.866    0.892
# 7     AR =~ wrrs_ar_3   0.888 0.007 128.446  0.000    0.874    0.901
# 8     AR =~ wrrs_ar_4   0.750 0.010  71.761  0.000    0.729    0.770
# 9     PP =~ wrrs_pp_1   0.796 0.010  79.324  0.000    0.777    0.816
# 10    PP =~ wrrs_pp_2   0.831 0.009  95.272  0.000    0.814    0.848
# 11    PP =~ wrrs_pp_3   0.809 0.009  86.460  0.000    0.791    0.827
# 12    PP =~ wrrs_pp_4   0.821 0.010  84.689  0.000    0.802    0.840
# 13    SQ =~     msq_1   0.777 0.011  70.637  0.000    0.756    0.799
# 14    SQ =~     msq_2   0.788 0.011  72.511  0.000    0.767    0.809
# 15    SQ =~     msq_3   0.784 0.010  75.719  0.000    0.763    0.804
# 16    SQ =~     msq_4   0.858 0.009  93.417  0.000    0.840    0.876
# 17  TASW ~~       TIB  -0.033 0.024  -1.390  0.164   -0.080    0.014
# 18    AR ~~       TIB  -0.053 0.023  -2.293  0.022   -0.098   -0.008
# 19    PP ~~       TIB  -0.092 0.023  -4.005  0.000   -0.136   -0.047
# 20    SQ ~~       TIB   0.086 0.023   3.813  0.000    0.042    0.130
# 106 TASW ~~        AR   0.297 0.022  13.235  0.000    0.253    0.340
# 107 TASW ~~        PP   0.635 0.016  39.966  0.000    0.604    0.666
# 108 TASW ~~        SQ  -0.245 0.025  -9.856  0.000   -0.294   -0.196
# 109   AR ~~        PP   0.674 0.014  49.755  0.000    0.648    0.701
# 110   AR ~~        SQ  -0.475 0.019 -24.957  0.000   -0.512   -0.438
# 111   PP ~~        SQ  -0.437 0.021 -21.219  0.000   -0.478   -0.397

# omega coefficients based on scale-specific CFA
compute_omega_from_cfa <- function(data, factors) {
  results <- data.frame(Factor=character(),Omega=numeric())
  
  for (f in names(factors)) {
    # selecting items
    items <- factors[[f]]
    item_str <- paste(items, collapse = " + ")
    # fitting model
    model <- paste0(f, " =~ ", item_str)
    fit <- cfa(model, data=data, ordered=items,
               estimator="WLSMV", std.lv=TRUE)
    # taking parameters
    std_sol <- standardizedSolution(fit)
    std_loadings <- subset(std_sol, op == "=~" & lhs == f)$est
    # computing total and error variance
    var_common <- sum(std_loadings)^2
    var_error <- sum(1 - std_loadings^2)
    # omega coefficient
    omega <- var_common / (var_common + var_error)
    results <- rbind(results, 
                     data.frame(Factor=f,Omega=round(omega, 3))) }
  return(results)}

# running function
factors_list <- list(
  TASW = c("tasw_1", "tasw_2", "tasw_3", "tasw_4"),
  AR   = c("wrrs_ar_1", "wrrs_ar_2", "wrrs_ar_3", "wrrs_ar_4"),
  PP   = c("wrrs_pp_1", "wrrs_pp_2", "wrrs_pp_3", "wrrs_pp_4"),
  SQ   = c("msq_1", "msq_2", "msq_3", "msq_4"))
omegas <- compute_omega_from_cfa(tot, factors_list)
# omegas$Omega
# [1] 0.927 0.910 0.887 0.879
```

```{r , echo = FALSE, out.width="300px"}
knitr::include_graphics("img/oniri_modello1.png")
```

\fontsize{7pt}{8}\selectfont
```{r , eval = FALSE}
library(lavaan)
fit1 <- cfa(m1,data=tot,ordered=ord_vars, estimator="WLSMV",std.lv=TRUE)
```
```{r , echo = FALSE,comment=NA}
fitind
```

## Results: Structural paths

```{r echo=FALSE,warning=FALSE,message=FALSE}
# model
m <- 
  '
  # measurement model
  TASW =~ tasw_1 + tasw_2 + tasw_3 + tasw_4
  AR =~ wrrs_ar_1 + wrrs_ar_2 + wrrs_ar_3 + wrrs_ar_4
  PP =~ wrrs_pp_1 + wrrs_pp_2 + wrrs_pp_3 + wrrs_pp_4
  SQ =~ msq_1 + msq_2 + msq_3 + msq_4
  
  # structural model
  SQ ~ TASW + AR + PP
  TIB ~ TASW + AR + PP
  '

# fitting model
fit1 <- cfa(m,data=tot,ordered=ord_vars,
            estimator="WLSMV",std.lv=TRUE)

# fit indices
fitind <- 
  round(lavInspect(fit1,"fit")[c("rmsea","cfi","tli","srmr")],3)
fitind <- c(fitind,round(lavInspect(fit1,"r2")["SQ"],2))
fitind <- c(fitind,round(lavInspect(fit1,"r2")["TIB"],2))
names(fitind)[5:6] <- c("R2_SQ","R2_TIB")

# parameters
pars <- standardizedsolution(fit1)
pars <- pars[pars$op %in% c("~","~~") &
               pars$lhs!=pars$rhs,]
#     lhs op  rhs est.std    se      z pvalue ci.lower ci.upper
# 17    SQ  ~ TASW  -0.019 0.035 -0.550  0.582   -0.087    0.049
# 18    SQ  ~   AR  -0.335 0.034 -9.960  0.000   -0.400   -0.269
# 19    SQ  ~   PP  -0.199 0.046 -4.336  0.000   -0.290   -0.109
# 20   TIB  ~ TASW   0.048 0.036  1.317  0.188   -0.023    0.119
# 21   TIB  ~   AR   0.028 0.037  0.764  0.445   -0.044    0.100
# 22   TIB  ~   PP  -0.141 0.049 -2.887  0.004   -0.236   -0.045
# 108 TASW ~~   AR   0.297 0.022 13.235  0.000    0.253    0.340
# 109 TASW ~~   PP   0.635 0.016 39.966  0.000    0.604    0.666
# 110   AR ~~   PP   0.674 0.014 49.755  0.000    0.648    0.701
# 111   SQ ~~  TIB   0.057 0.023  2.478  0.013    0.012    0.103
```

```{r , echo = FALSE, out.width="300px"}
knitr::include_graphics("img/oniri_modello2.png")
```

\fontsize{7pt}{8}\selectfont
```{r , eval = FALSE}
library(lavaan)
fit2 <- cfa(m2,data=tot,ordered=ord_vars, estimator="WLSMV",std.lv=TRUE)
```
```{r , echo = FALSE,comment=NA}
fitind
```

## Results: Mediation

```{r echo=FALSE,warning=FALSE,message=FALSE}
# model
m <- 
  '
  # measurement model
  TASW =~ tasw_1 + tasw_2 + tasw_3 + tasw_4
  AR =~ wrrs_ar_1 + wrrs_ar_2 + wrrs_ar_3 + wrrs_ar_4
  PP =~ wrrs_pp_1 + wrrs_pp_2 + wrrs_pp_3 + wrrs_pp_4
  SQ =~ msq_1 + msq_2 + msq_3 + msq_4
  
  # structural model with mediation TASW -> PP -> TIB
  SQ ~ TASW + AR + PP
  
  # mediation effects X -> M
  AR ~ a1*TASW
  PP ~ a2*TASW
  
  # mediation effects M -> Y 
  SQ ~ b11*AR + b12*PP
  TIB ~ b21*AR + b22*PP
  
  # direct effects X -> Y
  SQ ~ c1*TASW
  TIB ~ c2*TASW
  
  # indirect effects
  ab_SQ_AR := a1*b11
  ab_SQ_PP := a2*b12
  ab_TIB_AR := a1*b21
  ab_TIB_PP := a2*b22
  
  # total effects
  tot_SQ_AR := a1*b11 + c1
  tot_SQ_PP := a2*b12 + c1
  tot_TIB_AR := a1*b21 + c2
  tot_TIB_PP := a2*b22 + c2
  
  # covariance AR PP
  AR ~~ PP
  '

# fitting model
fit1 <- cfa(m,data=tot,ordered=ord_vars,
            estimator="WLSMV",std.lv=TRUE)

# fit indices
fitind <- 
  round(lavInspect(fit1,"fit")[c("rmsea","cfi","tli","srmr")],3)
fitind <- c(fitind,round(lavInspect(fit1,"r2")["SQ"],2))
fitind <- c(fitind,round(lavInspect(fit1,"r2")["TIB"],2))
names(fitind)[5:6] <- c("R2_SQ","R2_TIB")

# parameters
pars <- standardizedsolution(fit1)
pars <- pars[pars$op %in% c("~","~~",":=") &
               pars$lhs!=pars$rhs,]
#            lhs op       rhs      label est.std    se      z pvalue ci.lower ci.upper
# 17          SQ  ~      TASW         c1  -0.019 0.035 -0.550  0.582   -0.087    0.049
# 18          SQ  ~        AR        b11  -0.335 0.034 -9.960  0.000   -0.400   -0.269
# 19          SQ  ~        PP        b12  -0.199 0.046 -4.336  0.000   -0.290   -0.109
# 20          AR  ~      TASW         a1   0.297 0.022 13.235  0.000    0.253    0.340
# 21          PP  ~      TASW         a2   0.635 0.016 39.966  0.000    0.604    0.666
# 22         TIB  ~        AR        b21   0.028 0.037  0.764  0.445   -0.044    0.100
# 23         TIB  ~        PP        b22  -0.141 0.049 -2.887  0.004   -0.236   -0.045
# 24         TIB  ~      TASW         c2   0.048 0.036  1.317  0.188   -0.023    0.119
# 25          AR ~~        PP              0.659 0.016 40.561  0.000    0.627    0.691
# 111         SQ ~~       TIB              0.057 0.023  2.478  0.013    0.012    0.103
# 149   ab_SQ_AR :=    a1*b11   ab_SQ_AR  -0.099 0.013 -7.751  0.000   -0.124   -0.074
# 150   ab_SQ_PP :=    a2*b12   ab_SQ_PP  -0.127 0.029 -4.294  0.000   -0.184   -0.069
# 151  ab_TIB_AR :=    a1*b21  ab_TIB_AR   0.008 0.011  0.763  0.445   -0.013    0.030
# 152  ab_TIB_PP :=    a2*b22  ab_TIB_PP  -0.089 0.031 -2.879  0.004   -0.150   -0.029
# 153  tot_SQ_AR := a1*b11+c1  tot_SQ_AR  -0.118 0.040 -2.938  0.003   -0.197   -0.039
# 154  tot_SQ_PP := a2*b12+c1  tot_SQ_PP  -0.146 0.025 -5.724  0.000   -0.196   -0.096
# 155 tot_TIB_AR := a1*b21+c2 tot_TIB_AR   0.056 0.042  1.344  0.179   -0.026    0.138
# 156 tot_TIB_PP := a2*b22+c2 tot_TIB_PP  -0.042 0.026 -1.622  0.105   -0.092    0.009
```

```{r , echo = FALSE, out.width="300px"}
knitr::include_graphics("img/oniri_modello3.png")
```

\fontsize{7pt}{8}\selectfont
```{r , eval = FALSE}
library(lavaan)
fit3 <- cfa(m3,data=tot,ordered=ord_vars, estimator="WLSMV",std.lv=TRUE)
```
```{r , echo = FALSE,comment=NA}
fitind
```

## Results: Control variables

```{r echo=FALSE,warning=FALSE,message=FALSE}
tot$WL <- apply(tot[,paste0("qws_",1:5)],1,mean)
tot$CT <- tot$sleep_chronotype.min

# model
m <- 
  '
  # measurement model
  TASW =~ tasw_1 + tasw_2 + tasw_3 + tasw_4
  AR =~ wrrs_ar_1 + wrrs_ar_2 + wrrs_ar_3 + wrrs_ar_4
  PP =~ wrrs_pp_1 + wrrs_pp_2 + wrrs_pp_3 + wrrs_pp_4
  SQ =~ msq_1 + msq_2 + msq_3 + msq_4
  
  # structural model with mediation TASW -> PP -> TIB
  SQ ~ TASW + AR + PP
  
  # mediation effects X -> M
  AR ~ a1*TASW
  PP ~ a2*TASW
  
  # mediation effects M -> Y 
  SQ ~ b11*AR + b12*PP
  TIB ~ b21*AR + b22*PP
  
  # direct effects X -> Y
  SQ ~ c1*TASW
  TIB ~ c2*TASW
  
  # indirect effects
  ab_SQ_AR := a1*b11
  ab_SQ_PP := a2*b12
  ab_TIB_AR := a1*b21
  ab_TIB_PP := a2*b22
  
  # total effects
  tot_SQ_AR := a1*b11 + c1
  tot_SQ_PP := a2*b12 + c1
  tot_TIB_AR := a1*b21 + c2
  tot_TIB_PP := a2*b22 + c2
  
  # covariance AR PP
  AR ~~ PP
  
  # control variables
  SQ  ~ WL + CT + gender + age
  TIB ~ WL + CT + gender + age
  '

# fitting model
fit1 <- cfa(m,data=tot,ordered=ord_vars,
            estimator="WLSMV",std.lv=TRUE)

# fit indices
fitind <- 
  round(lavInspect(fit1,"fit")[c("rmsea","cfi","tli","srmr")],3)
fitind <- c(fitind,round(lavInspect(fit1,"r2")["SQ"],2))
fitind <- c(fitind,round(lavInspect(fit1,"r2")["TIB"],2))
names(fitind)[5:6] <- c("R2_SQ","R2_TIB")

# parameters
pars <- standardizedsolution(fit1)
pars <- pars[pars$op %in% c("~","~~",":=") &
               pars$lhs!=pars$rhs,]
# pars
#            lhs op       rhs      label est.std    se       z pvalue ci.lower ci.upper
# 17          SQ  ~      TASW         c1   0.009 0.036   0.242  0.809   -0.062    0.079
# 18          SQ  ~        AR        b11  -0.220 0.035  -6.227  0.000   -0.289   -0.151
# 19          SQ  ~        PP        b12  -0.170 0.045  -3.746  0.000   -0.259   -0.081
# 20          AR  ~      TASW         a1   0.156 0.027   5.698  0.000    0.102    0.209
# 21          PP  ~      TASW         a2   0.567 0.021  27.600  0.000    0.527    0.608
# 22         TIB  ~        AR        b21   0.057 0.036   1.567  0.117   -0.014    0.128
# 23         TIB  ~        PP        b22  -0.131 0.045  -2.881  0.004   -0.220   -0.042
# 24         TIB  ~      TASW         c2   0.081 0.036   2.239  0.025    0.010    0.153
# 25          AR ~~        PP              0.581 0.022  25.993  0.000    0.537    0.624
# 26          SQ  ~        WL             -0.329 0.023 -14.192  0.000   -0.375   -0.284
# 27          SQ  ~        CT              0.058 0.026   2.213  0.027    0.007    0.110
# 28          SQ  ~    gender              0.134 0.026   5.204  0.000    0.084    0.185
# 29          SQ  ~       age             -0.044 0.026  -1.681  0.093   -0.096    0.007
# 30         TIB  ~        WL             -0.130 0.024  -5.471  0.000   -0.176   -0.083
# 31         TIB  ~        CT             -0.218 0.018 -11.803  0.000   -0.254   -0.182
# 32         TIB  ~    gender             -0.065 0.024  -2.673  0.008   -0.113   -0.017
# 33         TIB  ~       age             -0.206 0.023  -8.795  0.000   -0.252   -0.160
# 119         SQ ~~       TIB              0.079 0.026   3.003  0.003    0.027    0.130
# 121         WL ~~        CT              0.010 0.000      NA     NA    0.010    0.010
# 122         WL ~~    gender             -0.067 0.000      NA     NA   -0.067   -0.067
# 123         WL ~~       age             -0.088 0.000      NA     NA   -0.088   -0.088
# 125         CT ~~    gender              0.067 0.000      NA     NA    0.067    0.067
# 126         CT ~~       age             -0.233 0.000      NA     NA   -0.233   -0.233
# 128     gender ~~       age              0.013 0.000      NA     NA    0.013    0.013
# 171   ab_SQ_AR :=    a1*b11   ab_SQ_AR  -0.034 0.008  -4.104  0.000   -0.051   -0.018
# 172   ab_SQ_PP :=    a2*b12   ab_SQ_PP  -0.096 0.026  -3.684  0.000   -0.148   -0.045
# 173  ab_TIB_AR :=    a1*b21  ab_TIB_AR   0.009 0.006   1.519  0.129   -0.003    0.020
# 174  ab_TIB_PP :=    a2*b22  ab_TIB_PP  -0.074 0.026  -2.848  0.004   -0.125   -0.023
# 175  tot_SQ_AR := a1*b11+c1  tot_SQ_AR  -0.026 0.039  -0.660  0.510   -0.101    0.050
# 176  tot_SQ_PP := a2*b12+c1  tot_SQ_PP  -0.088 0.027  -3.222  0.001   -0.141   -0.034
# 177 tot_TIB_AR := a1*b21+c2 tot_TIB_AR   0.090 0.039   2.323  0.020    0.014    0.166
# 178 tot_TIB_PP := a2*b22+c2 tot_TIB_PP   0.007 0.026   0.278  0.781   -0.044    0.058
```

```{r , echo = FALSE, out.width="300px"}
knitr::include_graphics("img/oniri_modello4.png")
```

\fontsize{7pt}{8}\selectfont
```{r , eval = FALSE}
library(lavaan)
fit4 <- cfa(m4,data=tot,ordered=ord_vars, estimator="WLSMV",std.lv=TRUE)
```
```{r , echo = FALSE,comment=NA}
fitind
```

# Study #2

## Participants & Procedure

```{r , echo = FALSE, out.width="70px"}
# reading data
load("data/DATASETS/ema_clean.RData") # long-form
pq <- read.csv("data/DATASETS/t1_clean_ema.csv")

# removing paritcipants included in one but not in the other dataset
ema <- ema[!ema$ID %in% c("V29N2672","N07S380"),]
pq <- pq[pq$ID!="s04359",]

# recoding remote work
pq$remote <- FALSE
pq$remote[pq$job.hours_remote>0] <- TRUE
```

\begincols
  \begincol{.53\textwidth}

\fontsize{9pt}{12}\selectfont

`r fontawesome::fa(name = "user", height = "1em")` `r fontawesome::fa(name = "user", height = "1em")` `r fontawesome::fa(name = "user", height = "1em")`  \newline
`r nrow(pq)` employed adults \fontsize{7pt}{12}\selectfont (`r round(100*nrow(pq[pq$gender=="F",])/nrow(pq),1)`%F, `r round(mean(pq$age),1)` $\pm$ `r round(sd(pq$age),1)` y) \newline
Job tenure: `r round(mean(pq$job.tenure),1)` $\pm$ `r round(sd(pq$job.tenure),1)` y, `r round(mean(pq$job.hours),1)` $\pm$ `r round(sd(pq$job.hours),1)` hrs/week \newline
`r (round(100*table(pq$job.position)/nrow(pq)))[1]`% employees, `r (round(100*table(pq$job.position)/nrow(pq)))[4]`% managers, `r 100 - ((round(100*table(pq$job.position)/nrow(pq)))[1]+ (round(100*table(pq$job.position)/nrow(pq)))[4])`% other \newline 
`r (round(100*table(pq$remote)/nrow(pq)))[2]`% remote/hybrid workers \newline

\fontsize{9pt}{12}\selectfont
__Recruitment & Procedure__ \fontsize{7pt}{12}\selectfont \newline
Convenience sampling, 5-day EMA  \newline \fontsize{9pt}{12}\selectfont  `r nrow(ema)` daily observations


\endcol \begincol{.45\textwidth}

\fontsize{9pt}{12}\selectfont
__Exclusion criteria:__ \fontsize{7pt}{10}\selectfont

- Unemployed/Students/Trainees

- \color{red} Less than 6 work hours/day \color{black}

- Nocturnal shifts

- Careless resp. (attention checks)

- \color{red} Manual workers

- \color{red} Full remote workers

\endcol
  \endcols
  
```{r , echo = FALSE, out.width="250px"}
knitr::include_graphics("img/oniri_ema_protocol.png")
```

## **E**xperience **S**ampling **M**easures

\fontsize{7pt}{10}\selectfont
All using 7-point response scale (Not at all - A lot) "*Today, after work...*" \newline

\begincols
  \begincol{.5\textwidth}

\fontsize{8pt}{12}\selectfont 

\color{blue}
_Intensive smartphone-use scale_ \fontsize{5.5pt}{12}\selectfont \color{black} \newline (Fenner & Renn 2010; Eichberger et al 2021) \newline \fontsize{7pt}{10}\selectfont 4 items, back-translated (e.g. _“I was available for colleagues, customers, and boss until I went to bed_)

\fontsize{8pt}{12}\selectfont \color{blue}
_TASW reasons_ \color{black}: \fontsize{7pt}{10}\selectfont __S__ elf-initiated (e.g. *Work on mind*, *Planned*) vs. **O**ther-initiated (e.g. *Message*) vs. **N**o TASW \newline

\fontsize{8pt}{12}\selectfont \color{blue}
_Pers. Cognitions_ \fontsize{5.5pt}{12}\selectfont \newline \color{black} (Sonnentag et al. 2024, Rutten et al. 2022) \newline \fontsize{7pt}{10}\selectfont 3 items backward (e.g. *Kept thinking about things happened at work*), 3 items forward (e.g. *Thought about work I have to do in the next days*) \newline

\fontsize{8pt}{12}\selectfont \color{blue}
_Mini Sleep Qs_ \fontsize{5.5pt}{12}\selectfont \color{black} (Natale et al. 2008) \newline \fontsize{7pt}{10}\selectfont 4 items from "sleep" subscale \newline e.g., *Difficulties in falling asleep*

\fontsize{8pt}{12}\selectfont \color{blue}
_Sleep times_ \color{black}: bedtime + wake-up


\endcol \begincol{.5\textwidth}

\fontsize{7pt}{8}\selectfont

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
library(psych)
mr <- multilevel.reliability(x = ema, 
                       grp = "ID", 
                       Time = "day", 
                       items = paste0("tasw",1:4), 
                       lmer = TRUE, aov = FALSE 
                       )[c("RkF", "Rc")] 
```

TASW: $R_{kF}$ = `r round(mr[[1]],2)`, $R_C$ = `r round(mr[[2]],2)`

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
# aggregated scores
ema$TASW <- apply(ema[,paste0("tasw",1:4)],1,mean)
ema$PC <- apply(ema[,c(paste0("pcb",1:3),paste0("pcf",1:3))],1,mean)
ema$sd1 <- 8 - ema$sd2
ema$sd2 <- 8 - ema$sd2
ema$sd3 <- 8 - ema$sd3
ema$sd4 <- 8 - ema$sd4
ema$SQ <- apply(ema[,paste0("sd",1:4)],1,mean)

# anonymizing data (replacing IDs with "s1", "s2", etc.)
for(i in 1:nlevels(as.factor(ema$ID))){
  ema[ema$ID==levels(as.factor(ema$ID))[i],"ID"] <- i }

# TASW reasons
ema$tasw_r <- gsub("External","O",
                   gsub("Internal","S",
                        gsub("Mixed","M",
                             gsub("NoTASW","N",
                                  ema$tasw_reason))))

# plotting fluctuations - TASW
ggplot(ema[ema$ID%in%c(8,13),],
       aes(x=day)) +
  
  geom_smooth(aes(y=tasw1),
              color="pink",se=FALSE,span=0.9,alpha=0.6) + 
  geom_point(aes(y=tasw1),
             color="pink",size=3,alpha=0.6) +
  
  geom_smooth(aes(y=tasw2),
              color="pink",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=tasw2),
             color="pink",size=3,alpha=0.6,alpha=0.6) +
  
  geom_smooth(aes(y=tasw3),
              color="pink",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=tasw3),
             color="pink",size=3,alpha=0.6) +
  
  geom_smooth(aes(y=tasw4),
              color="pink",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=tasw4),
             color="pink",size=3,alpha=0.6) +
  
  # punteggio aggregato (media degli item)
  geom_smooth(aes(y=TASW),color="red",se=FALSE,span=0.9,lwd=2) +
  geom_point(aes(y=TASW),color="red",size=4) +
  
  # label (TASW reasons)
  geom_label(aes(label=tasw_r,y=TASW+1),size=3) +
  
  facet_wrap("ID",strip.position="left",nrow=1) +
  ylim(1,7) + xlab("") +
  scale_x_continuous(labels=c("Mon","Thu","Wed","Thu","Fry"))+
  theme(axis.title.y = element_blank(),
        plot.margin=grid::unit(c(0,0,0,0), "mm"))
```

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
mr <- multilevel.reliability(x = ema, 
                       grp = "ID", 
                       Time = "day", 
                       items = c(paste0("pcb",1:3),paste0("pcf",1:3)), 
                       lmer = TRUE, aov = FALSE 
                       )[c("RkF", "Rc")] 
```

Pers. Cognitions: $R_{kF}$ = `r round(mr[[1]],2)`, $R_C$ = `r round(mr[[2]],2)`

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
ggplot(ema[ema$ID%in%c(8,13),],
       aes(x=day)) +
  
  geom_smooth(aes(y=pcb1),
              color="pink",se=FALSE,span=0.9,alpha=0.6) + 
  geom_point(aes(y=pcb1),
             color="pink",size=3,alpha=0.6) +
  
  geom_smooth(aes(y=pcb2),
              color="pink",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=pcb2),
             color="pink",size=3,alpha=0.6,alpha=0.6) +
  
  geom_smooth(aes(y=pcb3),
              color="pink",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=pcb3),
             color="pink",size=3,alpha=0.6) +
  
  geom_smooth(aes(y=pcf1),
              color="lightblue",se=FALSE,span=0.9,alpha=0.6) + 
  geom_point(aes(y=pcf1),
             color="lightblue",size=3,alpha=0.6) +
  
  geom_smooth(aes(y=pcf2),
              color="lightblue",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=pcf2),
             color="lightblue",size=3,alpha=0.6,alpha=0.6) +
  
  geom_smooth(aes(y=pcf3),
              color="lightblue",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=pcf3),
             color="lightblue",size=3,alpha=0.6,alpha=0.6) +
  
  # punteggio aggregato (media degli item)
  geom_smooth(aes(y=PC),color="violet",se=FALSE,span=0.9,lwd=2) +
  geom_point(aes(y=PC),color="violet",size=4) +
  facet_wrap("ID",strip.position="left",nrow=1) +
  ylim(1,7) + xlab("") +
  scale_x_continuous(labels=c("Mon","Thu","Wed","Thu","Fry"))+
  theme(axis.title.y = element_blank())
```

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
library(psych)
mr <- multilevel.reliability(x = ema, 
                       grp = "ID", 
                       Time = "day", 
                       items = paste0("sd",1:4), 
                       lmer = TRUE, aov = FALSE 
                       )[c("RkF", "Rc")] 
```

Sleep quality: $R_{kF}$ = `r round(mr[[1]],2)`, $R_C$ = `r round(mr[[2]],2)`

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
ggplot(ema[ema$ID%in%c(8,13),],
       aes(x=day)) +
  
  geom_smooth(aes(y=sd1),
              color="lightblue",se=FALSE,span=0.9,alpha=0.6) + 
  geom_point(aes(y=sd1),
             color="lightblue",size=3,alpha=0.6) +
  
  geom_smooth(aes(y=sd2),
              color="lightblue",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=sd2),
             color="lightblue",size=3,alpha=0.6,alpha=0.6) +
  
  geom_smooth(aes(y=sd3),
              color="lightblue",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=sd3),
             color="lightblue",size=3,alpha=0.6) +
  
  geom_smooth(aes(y=sd4),
              color="lightblue",se=FALSE,span=0.9,alpha=0.6) +
  geom_point(aes(y=sd4),
             color="lightblue",size=3,alpha=0.6) +
  
  # punteggio aggregato (media degli item)
  geom_smooth(aes(y=SQ),color="blue",se=FALSE,span=0.9,lwd=2) +
  geom_point(aes(y=SQ),color="blue",size=4) +
  facet_wrap("ID",strip.position="left",nrow=1) +
  ylim(1,7) + xlab("") +
  scale_x_continuous(labels=c("Mon","Thu","Wed","Thu","Fry"))+
  theme(axis.title.y = element_blank())
```

\endcol
  \endcols

## Wearable measures

\begincols
  \begincol{.5\textwidth}

\fontsize{8pt}{12}\selectfont
Embrace Plus wristband  \fontsize{5.5pt}{12}\selectfont (Empatica, Milan) \newline \fontsize{7pt}{10}\selectfont
3-axis acc + PPG (64 Hz) \newline 
Replaced every 2 days (40-h memory) \newline \fontsize{8pt}{12}\selectfont

```{r , echo = FALSE, out.width="150px"}
knitr::include_graphics("img/embraceplus_orizontal.png")
```

__Pre-processing pipeline__ \fontsize{7pt}{10}\selectfont

- Raw ACC+PPG export (AVRO)
- Temporal synch. + signal extraction
- Sleep logs adjustements
- Sleep scoring with `GGIR` algorithm \fontsize{5.5pt}{12}\selectfont (van Hees et al. 2018) \fontsize{7pt}{10}\selectfont
- 5-min RMSSD over 1-min windows
- RMSSD averaging by 90-min epochs from sleep onset to wake-up only if ACC < 0.035 mg \newline

`r fontawesome::fa(name = "heart", height = "1em")` Thanks Marcello Scibaldi (uniBO)

\endcol \begincol{.5\textwidth}

\fontsize{7pt}{10}\selectfont

```{r eval=FALSE}
GGIR(
  ...
  mode=c(1:5),rmc.unit.acc = "g",
  ignorenonwear = FALSE, ...
  includenightcrit = 10,
  loglocation="path_to_sleeplog",
  sleepwindowType="SPT", ...)
```

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
ggplot(ema[ema$ID%in%c(8,13),],
       aes(x=day,y=SPT)) +
  # TIB
  geom_smooth(aes(y=SPT),color="black",se=FALSE,span=0.9,lwd=2) +
  geom_point(aes(y=SPT),color="black",size=4) +
  # TST
  geom_smooth(aes(y=TST),color="lightblue",se=FALSE,span=0.9,lwd=2) +
  geom_point(aes(y=TST),color="lightblue",size=4) +
  facet_wrap("ID",strip.position="left",nrow=1) +
  ylim(1,9) + xlab("") +
  scale_x_continuous(labels=c("Mon","Thu","Wed","Thu","Fry"))+
  theme(axis.title.y = element_blank()) +
  ggtitle("SPT and TST (hours)")
```

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
ggplot(ema[ema$ID%in%c(2,13),],
       aes(x=day,y=rmssd.s1)) +
  # TIB
  geom_smooth(aes(y=rmssd.s1),color="red",se=FALSE,span=0.9,lwd=2) +
  geom_point(aes(y=rmssd.s1),color="red",size=4) +
  facet_wrap("ID",strip.position="left",nrow=1) +
  xlab("") +
  scale_x_continuous(labels=c("Mon","Thu","Wed","Thu","Fry"))+
  theme(axis.title.y = element_blank()) +
  ggtitle("RMSSD in 'cycle' #1 (ms)")
```

\endcol \endcols

## Results: Descriptives

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=4,fig.height=1.5}
ema$WASO <- ema$WASO*60
desc <- 
  describe(ema[,c("TASW","PC","SQ",
                  "TST","WASO","SE")])[,c("n","mean","sd")]
desc$ICC <- c(round(statsBy(ema[,c("TASW","PC","SQ","TST","WASO","SE")],
                       group=ema$ID)$ICC1[1:6],2)) 
rownames(desc) <-
  c("TASW (1-7)","PC (1-7)","SQ (1-7)","TST (hours)","WASO (min)","SE (%)")
knitr::kable(desc,digits=2)
```

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=12,fig.height=1.5}

library(ggplot2); library(gridExtra)
p1 <- ggplot(ema,aes(TASW)) + geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p2 <- ggplot(ema,aes(PC))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p3 <- ggplot(ema,aes(SQ))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p4 <- ggplot(ema,aes(TST))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("TST (hrs)")
p5 <- ggplot(ema,aes(WASO))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("WASO (min)")
p6 <- ggplot(ema,aes(SE))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("SE (%)")
grid.arrange(p1,p2,p3,p4,p5,p6,nrow=1)
```

## Results: Level-specific correlations

```{r echo=FALSE,warning=FALSE,message=FALSE,fig.width=8,fig.height=4}
vars <- c("TASW","PC","SQ", "TST","WASO","SE")
wide <- aggregate(ema[,vars],
                  by=list(ema$ID),FUN = mean,
                  na.rm=TRUE) # cluster means
colnames(wide) <- # changing names
  c("ID",paste0(vars,"_m")) 
ema <- plyr::join(ema,wide,by="ID",type="left") # joining
# centering
ema$TASW_c <- ema$TASW - ema$TASW_m
ema$PC_c <- ema$PC - ema$PC_m
ema$SQ_c <- ema$SQ - ema$SQ_m
ema$TST_c <- ema$TST - ema$TST_m
ema$WASO_c <- ema$WASO - ema$WASO_m
ema$SE_c <- ema$SE - ema$SE_m
```

\fontsize{7pt}{10}\selectfont

- Below main diagonal: Between-individual (person mean scores, *N* = `r nrow(pq)`)

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=12,fig.height=1.5}

library(ggplot2); library(gridExtra)
p1 <- ggplot(ema,aes(TASW_m)) + geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p2 <- ggplot(ema,aes(PC_m))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p3 <- ggplot(ema,aes(SQ_m))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p4 <- ggplot(ema,aes(TST_m))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("TST (hrs)")
p5 <- ggplot(ema,aes(WASO_m))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("WASO (min)")
p6 <- ggplot(ema,aes(SE_m))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("SE (%)")
grid.arrange(p1,p2,p3,p4,p5,p6,nrow=1)
```

- Above main diagonal: Within-individual (person-mean-centered scores, *N* = `r nrow(na.omit(ema[,c("TASW","PC","SQ", "TST","WASO","SE")]))`)

```{r echo=FALSE,warning=FALSE,message=FALSE, fig.width=12,fig.height=1.5}

library(ggplot2); library(gridExtra)
p1 <- ggplot(ema,aes(TASW_c)) + geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p2 <- ggplot(ema,aes(PC_c))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p3 <- ggplot(ema,aes(SQ_c))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank())
p4 <- ggplot(ema,aes(TST_c))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("TST (hrs)")
p5 <- ggplot(ema,aes(WASO_c))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("WASO (min)")
p6 <- ggplot(ema,aes(SE_c))+ geom_histogram(bins=10) + theme(axis.title.y = element_blank()) + xlab("SE (%)")
grid.arrange(p1,p2,p3,p4,p5,p6,nrow=1)
```

```{r echo=FALSE,warning=FALSE,message=FALSE,fig.width=8,fig.height=3}
# level-specific correlations
cb <- round(cor(wide[,paste0(vars,"_m")],use="complete.obs"),2) 
cw <- round(cor(ema[,paste0(vars,"_c")],use="complete.obs"),2) 
cb[upper.tri(cb)] <- cw[upper.tri(cw)]
cors <- reshape2::melt(cb)
cors$Var1 <- factor(gsub("_m","",cors$Var1),levels=vars)
cors$Var2 <- factor(gsub("_m","",cors$Var2),levels=vars)
ggplot(data = cors,
       aes(x=Var1, y=Var2, fill=value)) + geom_tile() + labs(x="",y="") +
  # geom_text(aes(x=Var1,y=Var2,label=round(value,2)),color="black",size=3.5)+
  scale_fill_gradient2(low="darkblue",high="#f03b20",mid="white",midpoint=0,
                       limit = c(-1,1),space="Lab",name="Pearson\nCorrelation",
                       guide="legend",breaks=round(seq(1,-1,length.out = 11),2),
                       minor_breaks=round(seq(1,-1,length.out = 11),2)) +
  geom_text(aes(label=round(value,2))) +
  theme(axis.text = element_text(size=12),
        axis.text.x = element_text(angle=45,hjust=1),
        legend.key.size = unit(0.3, 'cm'))
```


# Discussion

## TASW effects on sleep quantity & quality

\fontsize{10pt}{12}\selectfont

- TASW: long-established construct with controversial consequences, yet still poorly investigated

Study #1 \fontsize{8pt}{10}\selectfont

  - Direct relationship with **sleep quality** mediated by AR & PP (small effects)
  - Weaker relationship with **sleep quantity** mediated by PP (small effects)
  - __Limitations__: Cross-sectional, self-report 
  - __Future steps__: Data filtering (e.g., remote work, technologies), \newline Chronotype as moderator

\fontsize{10pt}{12}\selectfont

Study #2 \fontsize{8pt}{10}\selectfont 

  - Meaningful fluctuations over time, but infrequent TASW 
  - Meaningful inter-individual correlations \newline with **sleep quality & quantity** (WASO, SE)
  - Weaker and counterintuitive intra-individual correlations 
  - __Limitations__: Small sample size, short protocol duration 
  - __Future steps__: Sleep-related HRV, Chronotype as moderator


## Practical implications

- Techno-invasion and technological pervasiveness \newline in the digital transition era

- Ultimate challenge: \color{red} Designing work to stay at work \color{black}

- __Primary prevention__: Work-life balance policies \newline (*right to disconnect*) + Managerial training

- __Secondary prevention__: Time management + Boundary control + Digital detox + Mindfullness

- Even more challenging: Convincing managers and employees that the potential benefits of TASW (performance, commitment) are not worth the \newline __negative impact__ on sleep, health, & work-life balance

# References

## Key references

\fontsize{6pt}{9}\selectfont

- Eurofound. (2017). Sixth European working conditions survey. European Foundation for the Improvement of Living and Working Conditions, Ed.

- Fenner, G. H., & Renn, R. W. (2010). Technology-assisted supplemental work and work-to-family conflict: The role of instrumentality beliefs, organizational expectations and time management. *Human relations, 63*(1), 63-82.

- Greenhaus, J. H., Collins, K. M., & Shaw, J. D. (2003). The relation between work–family balance and quality of life. *Journal of vocational behavior, 63*(3), 510-531.

- Kühner, C., Rudolph, C. W., Derks, D., Posch, M., & Zacher, H. (2023). Technology-assisted supplemental work: A meta-analysis. *Journal of Vocational Behavior, 142*, 103861.

- Ragu-Nathan, T. S., Tarafdar, M., Ragu-Nathan, B. S., & Tu, Q. (2008). The consequences of technostress for end users in organizations: Conceptual development and empirical validation. *Information systems research, 19*(4), 417-433.

## **ONIRICAMENTE (II ed)** \newline _Giornata di studi sulla Psicologia del Sonno_ \newline \fontsize{6pt}{12}\selectfont Roma, 13 giugno 2025

\begincols
  \begincol{0.4\textwidth}

```{r , echo = FALSE, out.width="120px"}
knitr::include_graphics("img/oniricamente.png")
```

\endcol \begincol{0.65\textwidth}

```{r , echo = FALSE, out.width="170px"}
knitr::include_graphics("img/oniri_thankyou.png")
```

\fontsize{6pt}{12}\selectfont __Luca Menghini, Merylin Monaro, Luciano Gamberini__ 
\fontsize{5.5pt}{12} \newline HTLab, HIT Research Centre, Dep. General Psychology \newline University of Padova

\endcol \endcols

```{r , echo = FALSE, out.width="280px"}
knitr::include_graphics("img/loghi_DARE.png")
```

\begincols
  \begincol{1\textwidth}

```{=tex}
\begin{center} 
```

\fontsize{10pt}{12}\selectfont Luca Menghini

\fontsize{7.5pt}{12}\selectfont \color{blue}luca.menghini@unipd.it

\fontsize{6.5pt}{12}\selectfont `r fontawesome::fa(name = "researchgate", fill="#65A1DF",height = "1em")` [profile/Luca-Menghini](https://www.researchgate.net/profile/Luca-Menghini)  `r fontawesome::fa(name = "twitter", fill="#65A1DF",height = "1em")` [@LuMenPsy](https://twitter.com/LuMenPsy) `r fontawesome::fa(name = "linkedin", fill="#65A1DF",height = "1em")` [in/menghiniluca](https://linkedin.com/in/menghiniluca/) `r fontawesome::fa(name = "github", fill="#65A1DF",height = "1em")` [Luca-Menghini](https://github.com/Luca-Menghini)

\fontsize{6pt}{12}\selectfont \color{black} R code available from \color{blue} [https://luca-menghini.github.io/pResentations](https://luca-menghini.github.io/pResentations)

```{=tex}
\end{center}
```

\endcol \begincol{0\textwidth}

\endcol \endcols